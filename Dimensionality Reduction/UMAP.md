---

# 한 줄 요약

> **UMAP은 "데이터의 근접 구조"를 보존하면서, 빠르고 유연하게 차원 축소를 수행**하는 비선형 알고리즘입니다.

---

# UMAP은 어디에 쓰이나요?

| 활용 분야               | 설명                                         |
|------------------------|----------------------------------------------|
| 고차원 시각화           | t-SNE처럼 2D/3D로 임베딩을 시각화           |
| 전처리 + 클러스터링     | K-means 전에 차원 축소로 사용                |
| 노이즈 제거             | 희소하고 복잡한 데이터에서 핵심 정보만 추출 |
| 텍스트/이미지 임베딩   | 임베딩 벡터를 축소하여 분석/시각화          |

---

# ✅ 작동 원리 (직관적으로)

1. **고차원 공간에서 이웃 그래프 생성**
   - 각 점의 주변 이웃(k-NN)을 찾고, **가중치 그래프**로 표현
   - (여기서 "Uniform Manifold"라는 이름이 등장)

2. **저차원 공간에서도 유사한 그래프를 구성**
   - 저차원 공간에서도 이웃관계를 유지하도록 점들을 배치

3. **두 그래프 구조를 비슷하게 만드는 방향으로 최적화**
   - 이 과정에서 UMAP의 **비선형 차원 축소**가 이루어짐

💡 핵심:  
**"이웃 정보 + 거리 관계"**를 가장 잘 보존하는 저차원 임베딩을 찾는 것

---

# t-SNE vs UMAP

| 항목             | t-SNE                            | UMAP                             |
|------------------|----------------------------------|----------------------------------|
| 목적             | 시각화에 최적화                 | 시각화 + 머신러닝 전처리         |
| 거리 보존        | 지역 거리(이웃)                  | 지역 + 전역 거리                 |
| 속도             | 느림                             | 빠름                             |
| 새로운 샘플 처리 | ❌ 불가능                         | ✅ 가능 (transform 지원)         |
| 매개변수 영향력  | 높음                             | 비교적 낮음                      |
| 학습 가능성      | ❌ (비지도 only)                 | ✅ (지도학습도 가능)             |

---

# 주요 하이퍼파라미터

| 파라미터       | 설명                                       | 기본값 |
|----------------|--------------------------------------------|--------|
| `n_neighbors`  | 한 점 주변의 이웃 수. 클수록 전역 구조 보존| 15     |
| `min_dist`     | 점들이 얼마나 가까이 모일 수 있는지        | 0.1    |
| `n_components` | 축소할 차원 수 (2 or 3 or 그 이상)         | 2      |
| `metric`       | 거리 계산 방식 (euclidean, cosine 등)       | euclidean |

---

# Python 실습 예제 (digits 데이터)

```python
import umap.umap_ as umap
from sklearn.datasets import load_digits
import matplotlib.pyplot as plt

# 데이터 로드
digits = load_digits()
X = digits.data
y = digits.target

# UMAP 적용
umap_model = umap.UMAP(n_neighbors=15, min_dist=0.1, n_components=2, random_state=42)
X_umap = umap_model.fit_transform(X)

# 시각화
plt.figure(figsize=(8,6))
plt.scatter(X_umap[:, 0], X_umap[:, 1], c=y, cmap='Spectral', s=10)
plt.title("UMAP projection (2D)")
plt.colorbar(label='Digit Label')
plt.show()
```

> 🔧 설치 필요: `pip install umap-learn`

---

# 실전 팁

- `n_neighbors`:
  - 작으면 **지역적 구조 강조 (군집 뚜렷함)**
  - 크면 **전체 구조 보존 (부드러움)**
- `min_dist`:
  - 작으면 **군집이 더 타이트**
  - 크면 **더 퍼져 보임**

---

# 고급 활용

- `transform()` 메서드 사용으로 **새로운 샘플에 대한 차원 축소 가능**
- `supervised=True` 옵션으로 **라벨 정보 사용 가능**
- TF-IDF / BERT / 이미지 임베딩 등과 궁합 좋음

---

# 요약

| 특징         | UMAP 설명                                |
|--------------|-------------------------------------------|
| 성격         | 비선형, 거리 보존, 그래프 기반 임베딩     |
| 강점         | 빠름, 새로운 데이터 적용 가능             |
| 약점         | 수학적 해석은 어려움                     |
| 대표 용도    | 시각화, 클러스터링, 임베딩 전처리        |

---
